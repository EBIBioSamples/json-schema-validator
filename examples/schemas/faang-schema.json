{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "FAANG standard schema",
  "description": "Schema based on rules found in https://www.ebi.ac.uk/vg/faang/rule_sets/FAANG%20Samples.",

  "type": "object",
  "properties": {

    "alias": {
      "description": "A sample unique identifier in a submission.",
      "type": "string"
    },
    "taxonId": {
      "description": "The taxonomy id for the sample species.",
      "type": "integer"
    },
    "taxon": {
      "description": "The taxonomy name for the sample species.",
      "type": "string"
    },
    "title": {
      "description": "A sample title.",
      "type": "string"
    },
    "description": {
      "description": "A brief description of the sample including species name.",
      "type": "string"
    },

    "attributes": {
      "description": "Attributes for describing a sample.",
      "type": "object",
      "properties": {
        "material": {
          "description": "The type of material being described.",
          "type": "object",
          "properties": {
            "value": {
              "type": "string",
              "enum": [
                "organism",
                "specimen from organism",
                "cell specimen",
                "pool of specimens",
                "cell culture",
                "cell line"
              ]
            },
            "ontologyTerms": {
              "type": "string",
              "format": "url"
            }
          },
          "if": {"properties": {"value": {"pattern": "^organism$"}}},
          "then": {"properties": {"ontologyTerms": {"pattern": "\\S*?OBI_0100026$"}}},
          "else": {
            "if": {"properties": {"value": {"pattern": "^specimen from organism$"}}},
            "then":{"properties": {"ontologyTerms": {"pattern": "\\S*?OBI_0001479$"}}},
            "else": {
              "if": {"properties": {"value": {"pattern": "^cell specimen$"}}},
              "then": {"properties": {"ontologyTerms": {"pattern": "\\S*?OBI_0001468$"}}},
              "else": {
                "if": {"properties": {"value": {"pattern": "^pool of specimens"}}},
                "then": {"properties": {"ontologyTerms": {"pattern": "\\S*?OBI_0302716$"}}},
                "else": {
                  "if": {"properties": {"value": {"pattern": "^cell culture"}}},
                  "then": {"properties": {"ontologyTerms": {"pattern": "\\S*?OBI_0001876$"}}},
                  "else": {
                    "properties": {"ontologyTerms": {"pattern": "\\S*?CLO_0000031$"}}
                  }
                }
              }
            }
          },
          "required": ["value", "ontologyTerms"]
        },
        "project": {
          "description": "State that the project is 'FAANG'",
          "const": "FAANG"
        },
        "availability": {
          "discription": "Either a link to a web page giving information on sample availability (who to contact and if the sample is available).",
          "type": "string",
          "format": "uri"
        },
        "purification_protocol": {
          "description": "[Cell specimen] Link to protocol describing how the cells were purified",
          "type": "string",
          "format": "uri"
        },
        "cell_type": {
          "description": "[Cell specimen] Provide a cell type from the CL ontology.",
          "type": "string",
          "format": "uri"
        },
        "markers": {
          "description": "[Cell specimen] Markers used to isolate and identify the cell type (e.g. for FACS sorted cells)",
          "type": "string"
        },
        "poolCreationDate": {
          "description": "[Pool of specimens] Date at which the pool was created.",
          "type": "string",
          "format": "date"
        },
        "poolCreationProtocol": {
          "description": "[Pool of specimens] A link to the protocol for pool of specimens creation.",
          "type": "string",
          "format": "uri"
        },
        "specimenVolume": {
          "description": "[Pool of specimens] Pool specimen volume. Total sum from multiple specimens.",
          "type": "integer"
        },
        "sampleRelationships": {
          "description": "List of relationships between samples.",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "target": {
                "description": "Sample accession to which the sample relationship refers to.",
                "type": "string",
                "pattern": "^SAM[END][AG]?[0-9]+"
              },
              "nature": {
                "description": "Nature of the relationship between the samples.",
                "enum": ["same as", "derived from"]
              }
            },
            "required": ["target", "nature"]
          }
        }
      },
      "if": {
        "properties": {"material": {"properties": {"value": {"pattern": "^cell specimen$"}}}}
      },
      "then": {
        "required": ["material", "project", "cell_type", "purification_protocol", "sampleRelationships"],
        "properties": {"sampleRelationships": {"contains": {
          "type": "object",
          "properties": {"nature": {"pattern": "^derived from$"}}
        }}}
      },
      "else": {
        "if": {
          "properties": {"material": {"properties": {"value": {"pattern": "^pool of specimens$"}}}}
        },
        "then": {
          "required": ["material", "project", "poolCreationDate", "poolCreationProtocol", "sampleRelationships"],
          "properties": {"sampleRelationships": {"contains": {
            "type": "object",
            "properties": {"nature": {"pattern": "^derived from$"}}
          }}}
        },
        "else" :{
          "required": ["material", "project"]
        }
      }
    }
  },
  "required": ["alias", "taxonId", "attributes"]
}